# Микросервис для работы с гостями

Это проект для тестового задания на позицию PHP Backend Developer. Микросервис реализует API для CRUD операций с сущностью "Guest", с использованием PHP и Symfony, а также с поддержкой работы в контейнере Docker.

## Описание

Микросервис предоставляет API для создания, чтения, обновления и удаления записей гостей. Каждая запись содержит информацию о госте, такую как имя, фамилия, телефон, email и страна. Если страна не указана, она автоматически определяется по номеру телефона.

### Основные требования:
- Имя, фамилия и телефон — обязательные поля.
- Поля `phone` и `email` уникальны.
- Если страна не указана, она определяется из кода страны в номере телефона.
- API должно поддерживать работу в Docker-контейнере.
- В ответах сервера должны присутствовать заголовки `X-Debug-Time` и `X-Debug-Memory`, которые указывают на время выполнения запроса и потребляемую память.

## Стек технологий

- **PHP** — основной язык разработки.
- **Symfony** — фреймворк для разработки API.
- **Docker** — для контейнеризации приложения.
- **PostgreSQL** — СУБД для хранения данных.
- **libphonenumber** — библиотека для работы с номерами телефонов (для извлечения информации о стране).

## Структура проекта

- **src/Controller** — контроллеры API для обработки запросов.
- **src/Entity** — сущности Doctrine (модели данных).
- **src/Form** — формы для обработки данных (при необходимости).
- **config** — конфигурационные файлы для Symfony и Docker.
- **Dockerfile** — для создания Docker-образа.
- **docker-compose.yml** — для запуска приложения и базы данных через Docker.

## API эндпоинты

### 1. Получение списка всех гостей

**URL**: `/guest`

**Метод**: `GET`

**Ответ**:
```json
[
  {
    "id": 1,
    "name": "Иван",
    "surname": "Иванов",
    "phone": "+79000000000",
    "email": "ivanov@mail.ru",
    "country": "RU"
  },
  ...
]
```

### 2. Создание нового гостя

**URL**: `/guest/new`

**Метод**: `POST`

**Тело запроса:**:
```json
{
  "name": "Иван",
  "surname": "Иванов",
  "phone": "+79000000000",
  "email": "ivanov@mail.ru"
}
```

**Ответ**:
```json
{
  "id": 1,
  "name": "Иван",
  "surname": "Иванов",
  "phone": "+79000000000",
  "email": "ivanov@mail.ru",
  "country": "RU"
}
```

### 3. Получение информации о конкретном госте

**URL**: `/guest/{id}`

**Метод**: `GET`

**Ответ**:
```json
{
  "id": 1,
  "name": "Иван",
  "surname": "Иванов",
  "phone": "+79000000000",
  "email": "ivanov@mail.ru",
  "country": "RU"
}
```

### 4. Частичное обновление информации о госте

**URL**: `/guest/{id}/edit`

**Метод**: `PATCH`

**Тело запроса:**:
```json
{
  "name": "Иван",
  "surname": "Петров"
}
```

**Ответ**:
```json
{
  "id": 1,
  "name": "Иван",
  "surname": "Петров",
  "phone": "+79000000000",
  "email": "ivanov@mail.ru",
  "country": "RU"
}
```

### 5. Удаление гостя

**URL**: `/guest/{id}`

**Метод**: `DELETE`

**Ответ**:
```json
{
  "message": "Guest deleted successfully."
}
```

## Заголовки в ответах

В каждом ответе будут присутствовать следующие заголовки:

- **X-Debug-Time**: Время выполнения запроса в миллисекундах.
- **X-Debug-Memory**: Количество памяти в Кб, использованное при выполнении запроса.

## Как запустить

### Требования

- Docker
- Docker Compose

### Запуск с помощью Docker

1. Клонируйте репозиторий:
```bash
git clone https://github.com/Oqiewu/bnovo-test-task.git
cd guest-microservice
```

2. Запустите контейнеры с помощью Docker Compose:
```bash
docker-compose up --build
```

3. После того как контейнеры запустятся, микросервис будет доступен по адресу http://localhost:8000.

